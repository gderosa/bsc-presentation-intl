<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>~/Scrivania/tunnel.code+data/tunnel.mxm.html</title>
<meta name="Generator" content="Vim/7.1">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
</head>
<body bgcolor="#ffffff" text="#000000"><font face="monospace">
<font color="#0000ff">/* tunnel.mxm</font><br>
<font color="#0000ff">&nbsp;*</font><br>
<font color="#0000ff">&nbsp;* A symbolic+numeric simulation of the tunnel quantum effect&nbsp;&nbsp; </font><br>
<font color="#0000ff">&nbsp;* Copyright (C) 2007, 2008 Guido De Rosa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><br>
<font color="#0000ff">&nbsp;*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br>
<font color="#0000ff">&nbsp;* Thanks to Mariano Barbieri for ideas&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </font><br>
<font color="#0000ff">&nbsp;*/</font><br>
<br>
<font color="#6a5acd">globalsolve</font>&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">true</font><font color="#008b8b">;</font><br>
<font color="#6a5acd">assume</font><font color="#008b8b">(</font>E<font color="#6a5acd">&gt;</font><font color="#ff00ff">0</font><font color="#008b8b">);</font><br>
<font color="#6a5acd">assume</font><font color="#008b8b">(</font>m<font color="#6a5acd">&gt;</font><font color="#ff00ff">0</font><font color="#008b8b">);</font><br>
<font color="#6a5acd">assume</font><font color="#008b8b">(</font>E<font color="#6a5acd">&lt;</font>V<font color="#008b8b">);</font><br>
<br>
<font color="#0000ff">/* general solutions for potential barrier */</font><br>
psi1<font color="#008b8b">(</font>x<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;<font color="#6a5acd">exp</font><font color="#008b8b">(</font>%i<font color="#6a5acd">*</font>x<font color="#6a5acd">*</font><font color="#6a5acd">sqrt</font><font color="#008b8b">(</font><font color="#ff00ff">2</font><font color="#6a5acd">*</font>m<font color="#6a5acd">*</font>E<font color="#008b8b">)</font><font color="#6a5acd">/</font>hbar<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">+</font>&nbsp;A2<font color="#6a5acd">*</font><font color="#6a5acd">exp</font><font color="#008b8b">(</font><font color="#6a5acd">-</font>%i<font color="#6a5acd">*</font>x<font color="#6a5acd">*</font><font color="#6a5acd">sqrt</font><font color="#008b8b">(</font><font color="#ff00ff">2</font><font color="#6a5acd">*</font>m<font color="#6a5acd">*</font>E<font color="#008b8b">)</font><font color="#6a5acd">/</font>hbar<font color="#008b8b">);</font><br>
psi2<font color="#008b8b">(</font>x<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;C1<font color="#6a5acd">*</font><font color="#6a5acd">exp</font><font color="#008b8b">(</font>x<font color="#6a5acd">*</font><font color="#6a5acd">sqrt</font><font color="#008b8b">((</font>V<font color="#6a5acd">-</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>m<font color="#008b8b">)</font><font color="#6a5acd">/</font>hbar<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">+</font>&nbsp;C2<font color="#6a5acd">*</font><font color="#6a5acd">exp</font><font color="#008b8b">(</font><font color="#6a5acd">-</font>x<font color="#6a5acd">*</font><font color="#6a5acd">sqrt</font><font color="#008b8b">((</font>V<font color="#6a5acd">-</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>m<font color="#008b8b">)</font><font color="#6a5acd">/</font>hbar<font color="#008b8b">);</font><br>
psi3<font color="#008b8b">(</font>x<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;B1<font color="#6a5acd">*</font><font color="#6a5acd">exp</font><font color="#008b8b">(</font>%i<font color="#6a5acd">*</font>x<font color="#6a5acd">*</font><font color="#6a5acd">sqrt</font><font color="#008b8b">(</font><font color="#ff00ff">2</font><font color="#6a5acd">*</font>m<font color="#6a5acd">*</font>E<font color="#008b8b">)</font><font color="#6a5acd">/</font>hbar<font color="#008b8b">);</font><br>
<br>
<font color="#0000ff">/* and their derivatives */</font><br>
Dpsi1<font color="#008b8b">(</font>x<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;<font color="#6a5acd">diff</font><font color="#008b8b">(</font>psi1<font color="#008b8b">(</font>x<font color="#008b8b">),</font>x<font color="#008b8b">);</font><br>
Dpsi2<font color="#008b8b">(</font>x<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;<font color="#6a5acd">diff</font><font color="#008b8b">(</font>psi2<font color="#008b8b">(</font>x<font color="#008b8b">),</font>x<font color="#008b8b">);</font><br>
Dpsi3<font color="#008b8b">(</font>x<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;<font color="#6a5acd">diff</font><font color="#008b8b">(</font>psi3<font color="#008b8b">(</font>x<font color="#008b8b">),</font>x<font color="#008b8b">);</font><br>
<br>
<font color="#0000ff">/* regularity condition on wavefunction and derivative */</font><br>
reg12 <font color="#6a5acd">:</font>&nbsp;psi1<font color="#008b8b">(</font>x1<font color="#008b8b">)</font><font color="#6a5acd">=</font>psi2<font color="#008b8b">(</font>x1<font color="#008b8b">);</font><br>
reg23 <font color="#6a5acd">:</font>&nbsp;psi2<font color="#008b8b">(</font>x2<font color="#008b8b">)</font><font color="#6a5acd">=</font>psi3<font color="#008b8b">(</font>x2<font color="#008b8b">);</font><br>
Dreg12 <font color="#6a5acd">:</font>&nbsp;Dpsi1<font color="#008b8b">(</font>x1<font color="#008b8b">)</font><font color="#6a5acd">=</font>Dpsi2<font color="#008b8b">(</font>x1<font color="#008b8b">);</font><br>
Dreg23 <font color="#6a5acd">:</font>&nbsp;Dpsi2<font color="#008b8b">(</font>x2<font color="#008b8b">)</font><font color="#6a5acd">=</font>Dpsi3<font color="#008b8b">(</font>x2<font color="#008b8b">);</font><br>
<br>
<font color="#0000ff">/* Simbolically solve the liner equations in A2,C1,C2,B1*/</font><br>
<font color="#6a5acd">linsolve</font><font color="#008b8b">([</font>reg12<font color="#008b8b">,</font>reg23<font color="#008b8b">,</font>Dreg12<font color="#008b8b">,</font>Dreg23<font color="#008b8b">],[</font>A2<font color="#008b8b">,</font>C1<font color="#008b8b">,</font>C2<font color="#008b8b">,</font>B1<font color="#008b8b">]);</font><br>
<br>
psi1<font color="#008b8b">(</font>x<font color="#008b8b">);</font><br>
psi2<font color="#008b8b">(</font>x<font color="#008b8b">);</font><br>
psi3<font color="#008b8b">(</font>x<font color="#008b8b">);</font><br>
<br>
<font color="#0000ff">/* time evolution of each eigenfunction */</font><br>
Epsi1<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;psi1<font color="#008b8b">(</font>x<font color="#008b8b">)</font><font color="#6a5acd">*</font><font color="#6a5acd">exp</font><font color="#008b8b">(</font><font color="#6a5acd">-</font>%i<font color="#6a5acd">*</font>E<font color="#6a5acd">*</font>t<font color="#6a5acd">/</font>hbar<font color="#008b8b">);</font><br>
Epsi2<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;psi2<font color="#008b8b">(</font>x<font color="#008b8b">)</font><font color="#6a5acd">*</font><font color="#6a5acd">exp</font><font color="#008b8b">(</font><font color="#6a5acd">-</font>%i<font color="#6a5acd">*</font>E<font color="#6a5acd">*</font>t<font color="#6a5acd">/</font>hbar<font color="#008b8b">);</font><br>
Epsi3<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;psi3<font color="#008b8b">(</font>x<font color="#008b8b">)</font><font color="#6a5acd">*</font><font color="#6a5acd">exp</font><font color="#008b8b">(</font><font color="#6a5acd">-</font>%i<font color="#6a5acd">*</font>E<font color="#6a5acd">*</font>t<font color="#6a5acd">/</font>hbar<font color="#008b8b">);</font><br>
<br>
<font color="#0000ff">/* set the parameters of our problem */</font><br>
m&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">2</font><font color="#008b8b">;</font>&nbsp;<br>
hbar&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">0.1</font><font color="#008b8b">;</font>&nbsp;<br>
V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">1</font><font color="#008b8b">;</font>&nbsp;<br>
x1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">5.0</font><font color="#008b8b">;</font>&nbsp;<br>
x2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">5.1</font><font color="#008b8b">;</font>&nbsp;<br>
E0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">0.5</font><font color="#008b8b">;</font>&nbsp;<br>
sigmaE&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">0.1</font><font color="#008b8b">;</font>&nbsp;<br>
deltaE&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">1.5</font>&nbsp;<font color="#6a5acd">*</font>&nbsp;sigmaE<font color="#008b8b">;</font><br>
<br>
<font color="#0000ff">/* a generalized 'Fourier Transform' to make a superposition of </font><br>
<font color="#0000ff">&nbsp;* eigenfunctions by integrating f(E)*Epsi[1|2|3](x,E,t) over an interval</font><br>
<font color="#0000ff">&nbsp;* from E = E0-deltaE to E = E0+deltaE . A gaussian is a good choice</font><br>
<font color="#0000ff">&nbsp;* to obtaina a well localized packet</font><br>
<font color="#0000ff">&nbsp;*/</font><br>
f<font color="#008b8b">(</font>E<font color="#008b8b">)</font>&nbsp;<font color="#6a5acd">:=</font>&nbsp;<font color="#6a5acd">exp</font><font color="#008b8b">(</font><font color="#6a5acd">-</font><font color="#008b8b">(</font>E<font color="#6a5acd">-</font>E0<font color="#008b8b">)</font><font color="#6a5acd">^</font><font color="#ff00ff">2</font><font color="#6a5acd">/</font>sigmaE<font color="#6a5acd">^</font><font color="#ff00ff">2</font><font color="#008b8b">);</font><br>
<br>
<font color="#6a5acd">assume</font><font color="#008b8b">(</font>E<font color="#6a5acd">&lt;</font>V<font color="#008b8b">);</font><br>
<br>
<font color="#0000ff">/* boundaries for plotting ... */</font><br>
x0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">-</font><font color="#ff00ff">2</font><font color="#008b8b">;</font>&nbsp;<br>
x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">10</font><font color="#008b8b">;</font>&nbsp;<br>
xstep&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">0.0141</font><font color="#008b8b">;</font><br>
epsrel&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">0.2</font><font color="#008b8b">;</font>&nbsp;&nbsp;<font color="#0000ff">/* max relative error for numeric integration </font><br>
<font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *(quadpack): in practice, very rarely error</font><br>
<font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * is more than 5-10%; accuracy is good enough</font><br>
<font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * and we don't need to slowdown calculation</font><br>
<font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * any more...</font><br>
<font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</font><br>
limitq&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">5</font><font color="#008b8b">;</font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#0000ff">/* max number of subintervals for numeric </font><br>
<font color="#0000ff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *integration (quadpack) [ignored?] */</font><br>
ti&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">1.30</font><font color="#008b8b">;</font>&nbsp;<br>
tf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">14.8</font><font color="#008b8b">;</font>&nbsp;<br>
tstep&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">0.03750</font><font color="#008b8b">;</font>&nbsp;<br>
Emin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;E0 <font color="#6a5acd">-</font>&nbsp;deltaE<font color="#008b8b">;</font><br>
Emax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;E0 <font color="#6a5acd">+</font>&nbsp;deltaE<font color="#008b8b">;</font><br>
prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">&quot;tunnel-&quot;</font><font color="#008b8b">;</font>&nbsp;<font color="#0000ff">/* output filename prefix */</font><br>
<br>
<font color="#0000ff">/* For detailed pictures near the barrier, I used these settings instead: */</font><br>
<font color="#0000ff">/* </font><br>
<font color="#0000ff">x0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 3.0; </font><br>
<font color="#0000ff">x3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 6.5; </font><br>
<font color="#0000ff">ti&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 5; </font><br>
<font color="#0000ff">tf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: 12; </font><br>
<font color="#0000ff">tstep&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : 0.007; </font><br>
<font color="#0000ff">prefix&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: </font><font color="#ff00ff">&quot;barrier-&quot;</font><font color="#0000ff">; </font><br>
<font color="#0000ff">*/</font><br>
<br>
<font color="#0000ff">/* write data to a file... to be read by a Perl script which then prepares</font><br>
<font color="#0000ff">&nbsp;* chunks of data and commands for Gnuplot </font><br>
<font color="#0000ff">&nbsp;* </font><span style="background-color: #ffff00"><font color="#0000ff">TODO</font></span><font color="#0000ff">: ability to resume from a previously interrupted calculation.</font><br>
<font color="#0000ff">&nbsp;* </font><br>
<font color="#0000ff">&nbsp;* Instead, choose filename with a timestamp to avoid accidentally overwitings</font><br>
<font color="#0000ff">&nbsp;*/</font><br>
output_file <font color="#6a5acd">:</font>&nbsp;sconc<font color="#008b8b">(</font>prefix<font color="#008b8b">,</font><font color="#6a5acd">string</font><font color="#008b8b">(</font>absolute_real_time<font color="#008b8b">()),</font><font color="#ff00ff">&quot;.dat&quot;</font><font color="#008b8b">);</font><br>
stream<font color="#6a5acd">:</font>&nbsp;openw<font color="#008b8b">(</font>output_file<font color="#008b8b">);</font><br>
format<font color="#6a5acd">:</font>&nbsp;<font color="#ff00ff">&quot;~f ~f ~f ~f~%&quot;</font><font color="#008b8b">;</font>&nbsp;<font color="#0000ff">/* float */</font><br>
<br>
<font color="#a52a2a"><b>for</b></font>&nbsp;t<font color="#6a5acd">:</font>ti step tstep <font color="#a52a2a"><b>thru</b></font>&nbsp;tf <font color="#a52a2a"><b>do</b></font>&nbsp;<font color="#008b8b">(</font><br>
<br>
&nbsp;&nbsp;printf<font color="#008b8b">(</font>stream<font color="#008b8b">,</font><font color="#ff00ff">&quot;~%&quot;</font><font color="#008b8b">),</font><br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<font color="#0000ff">/* The superposition (wavepacket) is constructed&nbsp;&nbsp;*/</font><br>
&nbsp;&nbsp;<font color="#a52a2a"><b>for</b></font>&nbsp;x<font color="#6a5acd">:</font>&nbsp;x0 step xstep <font color="#a52a2a"><b>thru</b></font>&nbsp;x1 <font color="#a52a2a"><b>do</b></font>&nbsp;<font color="#008b8b">(</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;result_re <font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">quad_qags</font><font color="#008b8b">(</font>&nbsp;&nbsp;<font color="#0000ff">/*numerically integrate real... */</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">realpart</font><font color="#008b8b">(</font>f<font color="#008b8b">(</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>Epsi1<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)),</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emin<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emax<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epsrel<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limitq<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;result_im <font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">quad_qags</font><font color="#008b8b">(</font>&nbsp;<font color="#0000ff">/*...and imaginary part*/</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">imagpart</font><font color="#008b8b">(</font>f<font color="#008b8b">(</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>Epsi1<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)),</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emin<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emax<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epsrel<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limitq<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008b8b">),</font>&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">print</font><font color="#008b8b">(</font>x<font color="#008b8b">,</font>&nbsp;<font color="#ff00ff">&quot;= x &lt; x1; t =&quot;</font><font color="#008b8b">,</font>&nbsp;t<font color="#008b8b">,</font>&nbsp;<font color="#ff00ff">&quot; results:&quot;</font><font color="#008b8b">,</font>&nbsp;result_re<font color="#008b8b">,</font>&nbsp;result_im<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;printf<font color="#008b8b">(</font>stream<font color="#008b8b">,</font>format<font color="#008b8b">,</font>t<font color="#008b8b">,</font>x<font color="#008b8b">,</font>result_re<font color="#008b8b">[</font><font color="#ff00ff">1</font><font color="#008b8b">],</font>result_im<font color="#008b8b">[</font><font color="#ff00ff">1</font><font color="#008b8b">])</font><br>
&nbsp;&nbsp;<font color="#008b8b">),</font><br>
&nbsp;&nbsp;<font color="#a52a2a"><b>for</b></font>&nbsp;x<font color="#6a5acd">:</font>&nbsp;x1 step xstep <font color="#a52a2a"><b>thru</b></font>&nbsp;x2 <font color="#a52a2a"><b>do</b></font>&nbsp;<font color="#008b8b">(</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;result_re <font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">quad_qags</font><font color="#008b8b">(</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">realpart</font><font color="#008b8b">(</font>f<font color="#008b8b">(</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>Epsi2<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)),</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emin<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emax<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epsrel<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limitq<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;result_im <font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">quad_qags</font><font color="#008b8b">(</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">imagpart</font><font color="#008b8b">(</font>f<font color="#008b8b">(</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>Epsi2<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)),</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emin<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emax<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epsrel<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limitq<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">print</font><font color="#008b8b">(</font>x<font color="#008b8b">,</font>&nbsp;<font color="#ff00ff">&quot;= x in (x1,x2); t =&quot;</font><font color="#008b8b">,</font>t<font color="#008b8b">,</font><font color="#ff00ff">&quot; results:&quot;</font><font color="#008b8b">,</font>&nbsp;result_re<font color="#008b8b">,</font>&nbsp;result_im<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;printf<font color="#008b8b">(</font>stream<font color="#008b8b">,</font>format<font color="#008b8b">,</font>t<font color="#008b8b">,</font>x<font color="#008b8b">,</font>result_re<font color="#008b8b">[</font><font color="#ff00ff">1</font><font color="#008b8b">],</font>result_im<font color="#008b8b">[</font><font color="#ff00ff">1</font><font color="#008b8b">])</font><br>
&nbsp;&nbsp;<font color="#008b8b">),</font><br>
&nbsp;&nbsp;<font color="#a52a2a"><b>for</b></font>&nbsp;x<font color="#6a5acd">:</font>&nbsp;x2 step xstep <font color="#a52a2a"><b>thru</b></font>&nbsp;x3 <font color="#a52a2a"><b>do</b></font>&nbsp;<font color="#008b8b">(</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;result_re <font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">quad_qags</font><font color="#008b8b">(</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">realpart</font><font color="#008b8b">(</font>f<font color="#008b8b">(</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>Epsi3<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)),</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emin<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emax<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epsrel<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limitq<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;result_im <font color="#6a5acd">:</font>&nbsp;<font color="#6a5acd">quad_qags</font><font color="#008b8b">(</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">imagpart</font><font color="#008b8b">(</font>f<font color="#008b8b">(</font>E<font color="#008b8b">)</font><font color="#6a5acd">*</font>Epsi3<font color="#008b8b">(</font>x<font color="#008b8b">,</font>E<font color="#008b8b">,</font>t<font color="#008b8b">)),</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emin<font color="#008b8b">,</font>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Emax<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;epsrel<font color="#008b8b">,</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limitq<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#6a5acd">print</font><font color="#008b8b">(</font>x<font color="#008b8b">,</font>&nbsp;<font color="#ff00ff">&quot; = x &gt; x2; t=&quot;</font><font color="#008b8b">,</font>t<font color="#008b8b">,</font><font color="#ff00ff">&quot; results:&quot;</font><font color="#008b8b">,</font>&nbsp;result_re<font color="#008b8b">,</font>&nbsp;result_im<font color="#008b8b">),</font><br>
&nbsp;&nbsp;&nbsp;&nbsp;printf<font color="#008b8b">(</font>stream<font color="#008b8b">,</font>format<font color="#008b8b">,</font>t<font color="#008b8b">,</font>x<font color="#008b8b">,</font>result_re<font color="#008b8b">[</font><font color="#ff00ff">1</font><font color="#008b8b">],</font>result_im<font color="#008b8b">[</font><font color="#ff00ff">1</font><font color="#008b8b">])</font><br>
&nbsp;&nbsp;<font color="#008b8b">)</font><br>
&nbsp;<br>
<font color="#008b8b">);</font>&nbsp;<br>
</font></body>
</html>
